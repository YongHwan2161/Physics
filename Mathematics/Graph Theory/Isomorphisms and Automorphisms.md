# Isomorphisms
- Two graphs $G$ and $H$ are identical, written $G=H$, if $V(G)=V(H), E(G)=E(H)$, and $\psi_G=\psi_H$. If two graphs are identical, they can clearly be represented by identical diagrams. However, it is also possible for graphs that are not identical to have essentially the same diagram. For example, the graph $G$ and $H$ in [[Isomorphisms and Automorphisms#fig 1.6|Fig 1.6]] can be represented by diagrams which look exactly the same, as the second drawing of $H$ shows; the sole difference lies in the labels of their vertices and edges. Although the graph $G$ and $H$ are not identical, they do have identical structures, and are said to be isomorphic.
###### fig 1.6
![[Pasted image 20250209212335.jpg]]
- In general, two gaphs $G$ and $H$ are *isomorphic*, written $G\cong H$, if there are bijections $\theta:V(G)\to V(H)$ and $\phi:E(G)\to E(H)$ such that $\psi_G(e)=uv$ if and only if $\psi_H(\phi(e))=\theta(u)\theta(v)$; such a pair of mappings is called an *isomorphism* between $G$ and $H$.
- In order to show that two graphs are isomophic, one must indicate an isomorphism between them. The pair of mappings $(\theta, \phi)$ defined by $$\theta:=\left(\begin{array}{}a &b&c&d\\w&z&y&x\end{array}\right), \phi:=\left(\begin{array}{}e_1&e_2&e_3&e_4&e_5&e_6\\f_3&f_4&f_1&f_6&f_5&f_2\end{array}\right)$$ is isomorphism between the graphs $G$ and $H$ in [[Isomorphisms and Automorphisms#fig 1.6|Figure 1.6]].
## Isomorphism in simple graphs
- In the case of simple graphs, the definition of isomorphism can be stated more concisely, because if $(\theta, \phi)$ is an isomorphism between simple graphs $G$ and $H$, the mapping $\phi$ is completely determined by $\theta$; indeed, $\phi(e)=\theta(u)\theta(v)$ for any edge $e=uv$ of $G$. Thus one may define an isomorphism between two simple graphs $G$ and $H$ as a bijection $\theta: V(G)\to V(H)$ which preserves adjacency (that is, the vertices $u$ and $v$ are adjacent in $G$ if and only if their images $\theta(u)$ and $\theta(v)$ are adjacent in $H$).
- Consider, for example, the graphs $G$ and $H$ in [[Isomorphisms and Automorphisms#Figure 1.7|Figure 1.7]] 
###### Figure 1.7
![[Pasted image 20250210122123.jpg]]
The mapping$$\theta:=\left(\begin{array}{}1&2&3&4&5&6\\b&d&f&c&e&a\end{array}\right)$$ is an isomorphism between $G$ and $H$, as is $$\theta':=\left(\begin{array}{}1&2&3&4&5&6\\a&c&e&d&f&b\end{array}\right)$$
- Isomorphic graphs clearly have the same numbers of vertices and edges. On the other hand, equality of these parameters does not guarantee isomorphism. For instance, the two graphs shown in [[Isomorphisms and Automorphisms#Figure 1.8|Figure 1.8]] both have eight vertices and twelve edges, but they are not isomorphic. To see this, observe that the graph $G$ has four mutually nonadjacent vertices, $v_1, v_3, v_6, \text{ and } v_8$ of $H$ would like mutually nonadjacent. But it can readily be checked that no four vertices of $H$ are mutually nonadjacent. We deduce that $G$ and $H$ are not isomorphic.
###### Figure 1.8
![[Pasted image 20250210122929.jpg]]
- It is clear from the foregoing discussion that if two graphs are isomorphic, then they are either identical or differ merely in the names of their vertices and edges, and thus have the same structure. Because it is primarily in structural properties that we are interested, we often omit labels when drawing graphs; formally, we may define an *unlabelled graph* as a representative of an equivalence class of isomorphic graphs. We assign labels to vertices and edges in a graph mainly for the purpose of referring to them (in proofs, for instance).
- Up to isomorphism, there is just one complete graph on $n$ vertices, denoted $K_n$. Similarly, given two positive integers $m$ and $n$, there is a unique complete bipartite graph with parts of sizes $m$ and $n$, there is a unique complete bipartite graph with parts of sizes $m$ and $n$, (again, up to isomorphism), denoted $K_{m, n}$. In this notation, the graphs in [[Graphs and Their Representation#Figure 1.2|Figure 1.2]] are $K_5, K_{3,3}$, and $K_{1,5}$, respectively. Likewise, for any positive integer $n$, there is a unique path on $n$ vertices and a unique cycle on $n$ vertices. These graphs are denoted $P_n$ and $C_n$, respectively. The graphs depicted in [[Graphs and Their Representation#Figure 1.3|Figure 1.3]] and $P_4$ and $C_5$.
## Testing for Isomorphism
- Given two graphs on $n$ vertices, it is certainly possible in principle to determine whether are isomorphic. For instance, if $G$ and $H$ are simple, one could just consider each of the $n!$ bijections between $V(G)$ and $V(H)$ in turn, and check whether it is an isomorphism between the two grpahs. If the graphs happen to be isomorphic, an isomorphism might (with luck) be found quickly. On the other hand, if they are not isomorphic, one would need to check all $n!$ bijections to discover this fact. Unfortunately, even for moderately small values of $n$ (such as $n=100$), the number $n!$ is unmanageably large (indeed, larger than the number of particles in the universe!), so this 'brute force' approach is not feasible. Of course, if the graphs are not regular, the number of bijections to be checked will be smaller, as an isomorphism must map each vertex to a vertex of the same degree (Exercise 1.2.1a). Nonetheless, except in particular cases, this restriction does not serve to reduce their number sufficiently. Indeed, no efficient generally applicable procedure for testing isomorphism is known. However, by employing powerful group-theoretic methods, Luks (1982) devised an efficient isomorphism-testing algorithm for cubic graphs and, more generally, for graph of bounded maximum degree.
- There is another important matter related to algorithmic questions such as graph isomorphism. Suppose that two simple graphs $G$ and $H$ are isomorphic. It might not be easy to find an isomorphism between them, but once such an isomorphism $\theta$ has been found, it is a simple matter to verify that $\theta$ is indeed an isomorphism: one need merely check that, for each of the $\binom{n}{2}$ pairs $uv$ of vertices of $G$, $uv\in E(G)$ if and only if $\theta{u}\theta{v}\in E(H)$. On the other hand, if $G$ and $H$ happen not to be isomorphic, how can one verify this fact, short of checking all possible bijections between $V(G)$ and $V(H)$? In certain case, one might be able to show that $G$ and $H$ are not isomorphic by isolating some structural property of $G$ that is not shared by $H$ are not isomorphic by isolating some structural property of $G$ that is not shared by $H$, as we did for the graphs $G$ and $H$ of Figure 1.8. However, in general, verifying that two nonisomorphic graphs are indeed not isomorphic seems to be just as hard as determining in the first place whether they are isomorphic or not.
# Automorphisms
- An *automorphism* os a graph is an isomorphism of the graph to itself. In the case of a simple graph, an automorphism is just a permutation $\alpha$ of its vertex set which preserves adjacency: if $uv$ is an edge then so is $\alpha(u)\alpha(v)$.
- The automorphisms of a graph reflect its symmetries. For example, if $u$ and $v$ are two vertices of a simple graph, and if there is an automorphism $\alpha$ which maps $u$ and $v$, then $u$ and $v$ are alike in the graph, and are referred to as *similar* vertices. Graphs in which all vertices are similar, such as the complete graph $K_n$, the complete bipartite graph $K_{n,n}$ and the $n$-cube $Q_n$, are called *vertex-transitive*. Graphs in which no two vertices are similar are call *asymmetric*; these are the graphs which have only the identity permutation as automorphism(see Exercise 1.2.14).
- Particular drawings of a graph may often be used to display its symmetries. As an example, consider the three drawings shown in [[Isomorphisms and Automorphisms#Figure 1.9|Figure 1.9]] *Petersen graph*, a graph which turns out to have many special properties. (We leave it as an exercise (1.2.5) that they are indeed drawings of one and the same graph.) The first drawing shows that the five vertices of the outer pentagon are similar (under rotational symmetry), as are the five vertices of the inner pentagon. The third drawing exhibits six similar vertices (under reflective or rotational symmetry), namely the vertices of the outer hexagon. Combining these two observations, we conclude that all ten vertices of the Petersen graph are similar, and thus that the graph is vertex-transitive
###### Figure 1.9
![[Pasted image 20250213123635.jpg]]
- We donote the set of all automorphisms of a graph $G$ by $\operatorname{Aut}(G)$, and their number by $\operatorname{aut}(G)$. It can be verified that $\operatorname{Aut}(G)$ is a group under the operation of composition (Exercise 1.2.9). This group is called the *automorphism group* of permutations of its vertex set. In general, for any simple graph $G$ on $n$ vertices, $\operatorname{Aut}(G)$ is a subgroup of $S_n$. For instance, the automorphism group of $C_n$ is $D_n$, the dihedral group on $n$ elements(Exercise 1.2.10).
# Labelled Graphs
- As we have seen, the edge set $E$ of a simple graph $G=(V,E)$ is usually considered to be a subset of $\binom{V}{2}$, the set of all 2-subsets of $V$; edge labels may then be omitted in drawings of such graphs. A simple graph whose vertices are labelled, but whose edges are not, is referred to as a *labelled simple graph*. If $|V|=n$, there are $2^{\binom{n}{2}}$ distinct subsets of $\binom V2$, so $2^{\binom n2}$ labelled simple graphs with vertex set $V$. We denote by $\mathcal{G}_n$ the set of labelled simple graphs with vertex set $V:=\{v_1,v_2,\cdots,v_n\}$. The set $\mathcal{G}_3$ is shown in [[Isomorphisms and Automorphisms#Figure 1.10|Figure 1.10]].
###### Figure 1.10
![[Pasted image 20250217200503.jpg]]
- A *priori*, there are $n!$ ways of assigning the labels $v_1,v_2,\cdots,v_n$ to the vertices of an unlabelled simple graph on $n$ vertices. But two of these will yield the same labelled graph if there is an automorphism of the graph mapping one labelling to the other. For example, all six labellings of $K_3$ result in the same element of $\mathcal{G}_3$, whereas the six labellings of $P_3$ yield three distinct labelled graphs, as shown in [[Isomorphisms and Automorphisms#Figure 1.10|Figure 1.10]]. The number of distinct labellings of a given unlabelled simple graph $G$ on $n$ vertices is, in fact, $n!/\operatorname{aut}(G)$(Exercise 1.2.15). Consequently, $$\sum_G\frac{n!}{\operatorname{aut}(G)}=2^{\binom n2}$$ where the sum is over all unlabelled simple graphs on $n$ vertices. In particular, the number of unlabelled simple graphs on $n$ vetices is at least 
###### Equation 1.2
$$\left\lceil\frac{2^{\binom n2}}{n!}\right\rceil$$
- For small values of $n$, this bound is not particularly good. For example, there are four unlabelled simple graphs on three vertices, but the bound [[Isomorphisms and Automorphisms#Equation 1.2|eqn.1.2]] is just two. Likewise, the number of unlabelled simple graphs on four vertices is eleven (Exercise 1.2.6), whereas the bound given by [[Isomorphisms and Automorphisms#Equation 1.2|Equation 1.2]] is three. Nonetheless, when $n$ is large, this bound turns out to be a good approximation to the actual number of unlabelled simple graphs on $n$ vertices because the vast majority of graphs are asymmetric (see Exercise 1.2.15d).
# Exercises
## 1.2.1
- a) Show that any isomorphism between two graphs maps each vertex to a vertex of the same degree.
  - Let $G$ and $H$ be graphs and suppose $\theta:V(G)\to V(H)$, $uv\in E(G)\iff \theta(u)\theta(v)\in E(H)$.
  - Let $v\in V(G)$. The **degree** of $v$ in $G$, denoted $\operatorname{deg}_G(v)$, is the number of vertices adjacent to $v$. Let $$N_G(v)=\{u\in V(G):uv\in E(G)\}$$
  - Since $\theta$ is an isomorphism, for every $u\in N_G(v)$ we have that $uv\in E(G)$ implies $\theta(u)\theta(v)\in E(H)$
  - Moreover, since $\theta$ is a bijection, the mapping $u\mapsto \theta(u)$ 
  - $$\operatorname{deg}_G(v)=|N_G(v)|=|N_H(\theta(v))|=\operatorname{deg}_H(\theta(v))$$
  - Thus, any isomorphism $\theta$ between two graphs maps each vertex to a vertex of the same degree.
- b) Deduce that isomorphic graphs necessarily have the same (nonincreasing) degree sequence.
  - Since $\theta$ is a bijection and, by part (a), for every vertex $v$ in $G$ we have $$\operatorname{deg}_G(v)=\operatorname{deg}_H(\theta(v))$$
  - If we list the degree in nonincreasing order (that is, arrange the degrees from highest to lowest), the degree sequence of $G$ will be exactly the same as the degree sequence of $H$.
  - Thus, isomorphic graphs necessarily have the same (nonincreasing) degree sequence.
## 1.2.2 
- Show that the graphs in [[Isomorphisms and Automorphisms#Figure 1.11|Figure 1.11]] are not isomorphic (even though they have the same degree sequence).
###### Figure 1.11
![[Pasted image 20250224211728.jpg]]
## 1.2.3
- Let $G$ be a connected graph. Show that every graph which is isomorphic to $G$ is connected. (ref. [[Connected Graphs]] 
- Let $G$ be a connected graph and suppose that $H$ is isomorphic to $G$; that is, there exists an isomorphism $\theta: V(G)\to V(H)$
- 